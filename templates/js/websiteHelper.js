let streets = {'24 серпня': null, 'Біла': null, 'Білозіра І.': null, 'Базарна': null,
'Барнича Я.': null, 'Басараб Ольги': null, 'Бачинського Левка': null, 'Бельведерська': null,
'Бендери Степана': null, 'Берегова': null, 'Биха': null, 'Богунська': null, 'Бориславська': null,
'Ботанічна': null, 'Будівельний пров.': null, 'Будівельників': null, 'Букатчука': null, 'Буковинська': null,
'Відкрита': null, 'Військова': null, 'Вільна': null, 'Вінницька': null, 'Вінницький пров.': null,
'Вітовського Дмитра': null, 'Вічовий майдан': null, 'Вагилевича І.': null, 'Валова': null, 'Василіянок': null,
'Василишина П.': null, 'Вербицького Михайла': null, 'Вербова': null, 'Верховинська': null, 'Весела': null,
'Весняна': null, 'Виговського': null, 'Височана Семена': null, 'Вишнева': null, 'Вишнева (схід)': null,
'Вишневського': null, 'Воїнів-інтернаціоналістів': null, 'Вовчинецька': null, 'Волинська': null,
'Волошина А.': null, 'Вороного М.': null, 'Гаврилюка': null, 'Газова': null, 'Галечко Софії': null,
'Галицька': null, 'Гаморака': null, 'Гарбарська': null, 'Гаркуші': null, 'Гвардійська': null,
'Генерала Тарнавського': null, 'Героїв УПА': null, 'Герцена': null, 'Глібова': null, 'Глінки': null,
'Гнатюка Академіка': null, 'Гоголя': null, 'Головатого': null, 'Голуба': null, 'Горбачевського': null,
'Гординського С.': null, 'Грушевського М.': null, 'Грюнвальдська': null, 'Гулака-Артемовського': null,
'Гуцульська': null, 'Далека': null, 'Данилевського': null, 'Дашевського': null, 'Деповська': null,
'Джерельна': null, 'Дзівінського': null, 'Дністровська': null, 'Добролюбова': null, 'Довбуша': null,
'Довга': null, 'Довженка О.': null, 'Докучаєва': null, 'Донцова Д.': null, 'Дорошенка П. Гетьмана': null,
'Дослідна': null, 'Достоєвського': null, 'Драгоманова': null, 'Дружби': null, 'Дудаєва Джохара': null,
'Дунаєвського': null, 'Дучимінської Ольги': null, 'Електрична': null, 'Желехівського': null,
'Заболотівська': null, 'Загвіздянська': null, 'Заклинських': null, 'Залізнична': null, 'Заливахи О.': null,
'Замкнута': null, 'Запорізька': null, 'Зелена': null, 'Зорія': null, 'Зразкова': null,
'Калуське шосе': null, 'Каменярів': null, 'Кармелюка': null, 'Карпінця Я.': null, 'Карпатська': null,
'Карпенка-Карого': null, 'Каховська': null, 'Квіткова': null, 'Київська': null, 'Кисілевської О.': null,
'Княгинин': null, 'Кобилянської': null, 'Кобринської': null, 'Ковалевської': null, 'Ковальська': null,
'Козацька': null, 'Козланюка': null, 'Колективна': null, 'Коломийська': null, 'Комунальна': null,
'Кондукторська': null, 'Коновальця Євгена': null, 'Коперника': null, 'Короленка': null,
'Короля Данила': null, 'Коротка': null, 'Косівська': null, 'Котляревського': null, 'Коцюбинського': null,
'Кравецька': null, 'Кравченко Уляни': null, 'Крайківського': null, 'Красівського': null,
'Краснодонців': null, 'Крива': null, 'Кривоноса Максима': null, 'Кримська': null, 'Криховецька': null,
'Кропивницького': null, 'Крука Григора': null, 'Кулібіна': null, 'Курінного Чорноти': null,
'Курбаса Леся': null, 'Левинського': null, 'Левицького Романа': null, 'Лемківська': null,
'Ленкавського': null, 'Ленкавського пров.': null, 'Леонтовича': null, 'Лепкого Богдана': null,
'Лермонтова': null, 'Луначарського': null, 'Лучна': null, 'Львівська': null, 'Любачівського': null,
'Міхновського': null, 'Міцкевича пл.': null, 'Мазепи Гетьмана': null, 'Макогона': null, 'Максимовича': null,
'Макухи І.': null, 'Маланюка': null, 'Малицької Константини': null, 'Манюха В.': null,
'Марка Вовчка': null, 'Мартовича': null, 'Матейка': null, 'Мельничука': null, 'Менделеєва': null,
'Мечнікова': null, 'Микитинецька': null, 'Миколайчука Івана': null, 'Мирного Панаса': null,
'Мирона Івана': null, 'Миру': null, 'Млинарська': null, 'Молдавська': null, 'Молодіжна': null,
'Мочульського': null, 'Надвірнянська': null, 'Надрічна': null, 'Нафтова': null,
'Національної Гвардії': null, 'Незалежності': null, 'Некрасова': null, 'Нечуя -Левицького': null,
'Низова': null, 'Нова': null,
'Новгородська': null, 'Новий Світ': null, 'Івасюка': null, 'Ім. Стефаника Василя наб.': null,
'Індустріальна': null, 'Ірчана': null, 'Оборонна': null, 'Огарьова': null, 'Одеська': null,
'Озаркевича Євгена': null, 'Олесницького Ю.': null, 'Опільського Ю.': null, 'Опришівецька': null,
'Орлика Пилипа': null, 'Островського': null, 'Отця Блавацького І.': null, 'Південний бульв.': null,
'Північний ім. Пушкіна О. бульв.': null, 'Підгірянки Марійки': null, 'Павлика М.': null, 'Паркова': null,
'Пасічанська': null, 'Пасічна': null, 'Патона': null, 'Пашницького': null, 'Пекарська': null,
'Перехідна': null, 'Переяславська': null, 'Петлюри Симона': null, 'Петрака': null, 'Петрушевича': null,
'Подольська': null, 'Покутська': null, 'Полковника Андрусяка': null, 'Полковника Грома': null,
'Полотнюків': null, 'Полтавський пров.': null, 'Польова': null, 'Польова (захід)': null, 'Поперечна': null,
'Пржевальського': null, 'Привокзальна пл.': null, 'Промислова': null, 'Простора': null, 'Прутська': null,
'Пугачова': null, 'Пулюя Івана': null, 'Рівна': null, 'Радищева': null, 'Ребета Л.': null,
'Реміснича': null, 'Республіканська': null, 'Рильського': null, 'Ринок пл.': null, 'Робітнича': null,
'Розумовського': null, 'Ролана Ромена': null, 'Рудніва': null, 'Сєченова': null, 'Сєченова пров.': null,
'Сірика': null, 'Січеславська': null, 'Січинського': null, 'Січових Стрільців': null, 'Сабата М.': null,
'Сагайдачного Гетьмана': null, 'Самійленка': null, 'Сахарова Академіка': null, 'Світла': null,
'Селянська': null, 'Симиренка': null, 'Симоненка Василя': null, 'Сковороди': null, 'Снігуровича С.': null,
'Сніжна': null, 'Солотвинська': null, 'Сонячна': null, 'Сорохтея О.': null, 'Сосенка М.': null,
'Софіївка': null, 'Софіївський пров.': null, 'Спокійна': null, 'Спортивна': null, 'Станіславська': null,
'Старицького': null, 'Стефаника': null, 'Страчених': null, 'Стрийська': null, 'Стуса Василя': null,
'Сухомлинського': null, 'Тімірязєва': null, 'Танкістів': null, 'Технічна': null, 'Тисменицька': null,
'Тиха': null, 'Тичини': null, 'Товарна': null, 'Товарний пров.': null, 'Токарська': null, 'Толстого': null,
'Торгова': null, 'Тракторна': null, 'Трачів': null, 'Трильовського К.': null, 'Тринітарська': null,
'Тролейбусна': null, 'Трускавецька': null, 'Труша І.': null, 'Тудора Степана': null, 'Тургенєва': null,
'Угорницька': null, 'Ужгородська': null, 'Українки Лесі': null, 'Українська': null,
'Українських Декабристів': null, 'Урожайна': null, 'Ушинського': null, 'Фіголя М.': null,
'Федьковича': null, 'Флотська': null, 'Фортечний пров.': null, 'Франка Івана': null, 'Хіміків': null,
'Харківська': null, 'Хмельницького Богдана': null, 'Хотинська': null, 'Хоткевича Гната': null,
'Хриплинська': null, 'Ціолковського': null, 'Целевича Ю.': null, 'Церковна': null, 'Ципки': null,
'Чайковського': null, 'Челюскінців': null, 'Черемшини': null, 'Чехова': null, 'Чиста': null,
'Чорновола': null, 'Чубинського Павла': null, 'Шашкевича': null, 'Шевченка': null, 'Шептицького пл.': null,
'Шеремети': null, 'Шкільна': null, 'Шопена': null, 'Шота Руставелі': null, 'Шпитальна': null,
'Шухевичів': null, 'Яновича В.': null, 'Яремчука М.': null, 'Яросевича Романа': null, 'Ясінських': null,
'Ясна': null}

let dishes = {{ dishes | safe }};
let categories = {{ categories | safe }};
let lang = '{{ g.locale }}';

function incrementValue(id, cartBtn, button) {
    let input = document.getElementById(id);
    let currentVal = Number(input.value);
    let cartBtnInput;
    if (cartBtn == false) {
        cartBtnInput = {"value": 1};
    } else {
        cartBtnInput = document.getElementById(cartBtn);
    }

    if (currentVal == input.max) {
        button.disabled = true;
        input.value = currentVal;
        cartBtnInput.value = currentVal;
        if (id === "persons") {
            M.toast({
                html: `<b style="color:red;">{{ _('КАРАНТИН') }}!</b>`,
            });
        } else {
            M.toast({
                html: `<b style="color:red;">{{ _('Багато істи шкідливо') }}!</b>`,
            });
        }
    } else if (!isNaN(currentVal)) {
        input.value = currentVal + 1;
        cartBtnInput.value = currentVal + 1;
        if (id !== 'persons') {
            addToCart(button);
        }
    } else {
        input.value = 0;
        cartBtnInput.value = 0;
    }
}

function decrementValue(id, cartBtn, button) {
    let input = document.getElementById(id);
    let currentVal = Number(input.value);
    let cartBtnInput;
    if (cartBtn == false) {
        cartBtnInput = document.getElementById("fake-input");
    } else {
        cartBtnInput = document.getElementById(cartBtn);
    }

    if (currentVal == input.min) {
        input.value = currentVal;
        cartBtnInput.value = currentVal;
        if (id !== 'persons') {
            removeOfCart(button);
            $('#modal_dish').modal('close');
        }
    } else if (!isNaN(currentVal) && currentVal > 0) {
        input.value = currentVal - 1;
        cartBtnInput.value = currentVal - 1;
        if (id !== 'persons') {
            removeOfCart(button);
        }
    } else {
        input.value = 0;
        cartBtnInput.value = 0;
    }
}

function checkNum(id) {
    let input = document.getElementById(id);
    if (input.value > input.max) {
        input.value = input.max;
    } else if (input.value < input.min) {
        input.value = input.min;
    }
}

let navbar = $(".navbar");
let slider = $(".slider");
let counter = 0;

function scrollNavbar() {
    try {
        let scroll = $(window).scrollTop();
        let offset = slider.offset().top + slider.height() - 5;
        if (scroll > offset && counter == 0) {
            navbar.addClass("fixed");
            counter = 1;
        } else if (scroll < offset && counter == 1) {
            navbar.removeClass("fixed");
            counter = 0;
        }
    } catch {
        navbar.addClass("fixed");
    }
}

function getDataCart() {
    return JSON.parse(localStorage.getItem("cart")) || {};
}

function setDataCart(item) {
    localStorage.setItem("cart", JSON.stringify(item));
}

let cart = document.getElementById("cart");
let cartMob = document.getElementById("cart-mob");
let suma = 0;
let elemSuma = document.getElementById('suma');
let inputSuma = document.getElementById('input_total');
let inputCart = document.getElementById('input-cart');
let dishCart = document.getElementById("dish-cart");

function addToCart(button) {
    button.disabled = true;
    let cartData = getDataCart();
    let dish = button.getAttribute("data-id");
    cartData[dish] += 1;
    setDataCart(cartData);
    inputCart.value = JSON.stringify(cartData);

    let dishName = '';
    let dishPrice = 0;
    let dishCategory = '';
    for (let item of dishes) {
        if (item._id == dish) {
            suma += Number(item.price);
            elemSuma.innerText = suma +' {{ _("GBP") }}';
            inputSuma.value = suma

            dishName  = item.language.uk.name;
            dishPrice = item.price;

            for (let itemCateg of categories) {
                if (itemCateg._id == item.category) {
                    dishCategory = itemCateg.language.uk.name;
                }
            }
        }
    }

    dataLayer.push({ecommerce: null});
    dataLayer.push({
        event: "add_to_cart",
        ecommerce: {
            items: [{
                item_name: dishName,
                price:  dishPrice,
                item_category: dishCategory,
                quantity: cartData[dish]
            }]
        }
    });

    button.disabled = false;
}

function removeOfCart(button) {
    button.disabled = true;
    let cartData = getDataCart();
    let dish = button.getAttribute("data-id");
    if (cartData[dish] === 1) {
        delete cartData[dish];
        document.getElementById("dish-" + dish).remove();
        for (let item of dishes) {
            if (item._id == dish) {
                suma -= item.price;
                elemSuma.innerText = suma+' {{ _("GBP") }}';
                inputSuma.value = suma
            }
        }
    } else {
        cartData[dish] -= 1;
        for (let item of dishes) {
            if (item._id == dish) {
                suma -= Number(item.price);
                elemSuma.innerText = suma +' {{ _("GBP") }}';
            inputSuma.value = suma
            }
        }
    }
    setDataCart(cartData);
    inputCart.value = JSON.stringify(cartData);
    if (Object.keys(cartData).length == 0) {
        $('#modal_cart').modal("close");
        cart.innerHTML = cartMob.innerHTML = "";
        cart.innerHTML = cartMob.innerHTML = `
            <svg class="empty-cart" width="24" height="22" viewBox="0 0 24 22" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M1 7H2M19 7H18M18 7L17 17H3L2 7M18 7H16H14M2 7H4H6M10 11V13M13 11V13M7 11V13M6 7H14M6 7V5C6 3.66667 6.8 1 10 1C13.2 1 14 3.66667 14 5V7"
                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        `;
    }

    let dishName = '';
    let dishPrice = 0;
    let dishCategory = '';
    for (let item of dishes) {
        if (item._id == dish) {
            dishName  = item.language.uk.name;
            dishPrice = item.price;

            for (let itemCateg of categories) {
                if (itemCateg._id == item.category) {
                    dishCategory = itemCateg.language.uk.name;
                }
            }
        }
    }

    dataLayer.push({ecommerce: null});
    dataLayer.push({
        event: "remove_from_cart",
        ecommerce: {
            items: [{
                item_name: dishName,
                price:  dishPrice,
                item_category: dishCategory,
                quantity: 1
            }]
        }
    });

    button.disabled = false;
}

function removeDish(dish) {
    let cartData = getDataCart();
    let countDish = cartData[dish];
    document.getElementById("dish-" + dish).remove();
    for (let item of dishes) {
        if (item._id == dish) {
            suma -= Number(cartData[dish]) * Number(item.price);
            elemSuma.innerText = suma +' {{ _("GBP") }}';
            inputSuma.value = suma
        }
    }
    delete cartData[dish];
    setDataCart(cartData);
    inputCart.value = JSON.stringify(cartData);
    if (Object.keys(cartData).length == 0) {
        $('#modal_cart').modal("close");
        cart.innerHTML = cartMob.innerHTML = "";
        cart.innerHTML = cartMob.innerHTML = `
            <svg class="empty-cart" width="24" height="22" viewBox="0 0 24 22" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M1 7H2M19 7H18M18 7L17 17H3L2 7M18 7H16H14M2 7H4H6M10 11V13M13 11V13M7 11V13M6 7H14M6 7V5C6 3.66667 6.8 1 10 1C13.2 1 14 3.66667 14 5V7"
                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        `;
    }

    let dishName = '';
    let dishPrice = 0;
    let dishCategory = '';
    for (let item of dishes) {
        if (item._id == dish) {
            dishName  = item.language.uk.name;
            dishPrice = item.price;

            for (let itemCateg of categories) {
                if (itemCateg._id == item.category) {
                    dishCategory = itemCateg.language.uk.name;
                }
            }
        }
    }

    dataLayer.push({ecommerce: null});
    dataLayer.push({
        event: "remove_from_cart",
        ecommerce: {
            items: [{
                item_name: dishName,
                price:  dishPrice,
                item_category: dishCategory,
                quantity: countDish
            }]
        }
    });
}

function markupGenerator(item, cartData) {
    let markup = `
        \n<div class="cart-item row" id="dish-${item._id}">
            <div class="col s3">
                <img src="{{ url_for('static', filename='') }}${item.image}"
                    alt="${item.language[lang].name}">
            </div>
            <div class="col s9 cart-item-detail">
                <h3>${item.language[lang].name}</h3>
                <span class="delete" onclick="removeDish(${item._id})">&#10006;</span>
                <span class="ingredients">${item.language[lang].ingredients}</span>
                <div class="price">
                    <p>${item.price} {{ _('GBP') }}</p>
                </div>
                <div class="input-group count">
                    <input type="button" value="-" data-id="${item._id}" onclick="decrementValue('${item._id}', false, this)"
                        class="button-minus" data-field="${item._id}">
                    <input type="number" step="1" min="1" max="100" value="${
                        cartData[item._id]
                    }" id="${item._id}"
                        class="numbers-field" onkeyup="checkNum('${item._id}')">
                    <input type="button" value="+" data-id="${item._id}" onclick="incrementValue('${item._id}', false, this)"
                        class="button-plus" data-field="${item._id}">
                </div>
            </div>
        </div>
        `;
    return markup;
}

let = deliveryMarkup = `
    <span id='sum-delivery'>+ {{ _('доставка') }}</span>
`

function insertCart(button) {
    button.disabled = true;
    let cartData = getDataCart() || {};
    let dish = button.getAttribute("data-id");
    if (cartData.hasOwnProperty(dish)) {
        cartData[dish] += 1;
        document.getElementById(dish).value = cartData[dish];
        for (let item of dishes) {
            if (item._id == dish) {
                suma += Number(item.price);
                elemSuma.innerText = suma +' {{ _("GBP") }}';
                inputSuma.value = suma;
            }
        }
        M.toast({
            html: `<b style="color:green;">{{ _('Товар додано до кошика') }}</b>`,
        });
    } else {
        cartData[dish] = 1;
        M.toast({
            html: `<b style="color:green;">{{ _('Товар додано до кошика') }}</b>`,
        });
        for (let item of dishes) {
            if (item._id == dish) {
                let markup = markupGenerator(item, cartData);
                dishCart.insertAdjacentHTML("beforeend", markup);
                suma += Number(item.price);
                elemSuma.innerText = suma +' {{ _("GBP") }}';
                inputSuma.value = suma
            }
        }
    }
    setDataCart(cartData);
    inputCart.value = JSON.stringify(cartData);
    cart.innerHTML = cartMob.innerHTML = "";
    cart.innerHTML = cartMob.innerHTML = `
            <svg class="active-cart" width="24" height="22" viewBox="0 0 25 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M11.7984 4.64321C11.2233 4.39554 10.544 4.25 9.75 4.25C7.90556 4.25 6.6804 5.03532 5.94135 6.06177C5.22984 7.04998 5 8.21332 5 9V10.25H3.75H1.75H0.75C0.335786 10.25 0 10.5858 0 11C0 11.4142 0.335786 11.75 0.75 11.75H1.07126L2.00372 21.0746C2.04206 21.458 2.36469 21.75 2.75 21.75H16.75C17.1353 21.75 17.4579 21.458 17.4963 21.0746L18.3096 12.9416C17.8008 12.878 17.3078 12.7633 16.836 12.603L16.0713 20.25H3.42874L2.57874 11.75H3.75H5.75H13.75H15.1028C14.2698 11.1962 13.5538 10.4802 13 9.64724V10.25H6.5V9C6.5 8.45335 6.67016 7.61668 7.15865 6.93823C7.6196 6.29802 8.39444 5.75 9.75 5.75C10.676 5.75 11.3311 6.00575 11.8001 6.37193C11.767 6.08588 11.75 5.79493 11.75 5.5C11.75 5.21027 11.7664 4.92438 11.7984 4.64321ZM7.5 15C7.5 14.5858 7.16421 14.25 6.75 14.25C6.33579 14.25 6 14.5858 6 15V17C6 17.4142 6.33579 17.75 6.75 17.75C7.16421 17.75 7.5 17.4142 7.5 17V15ZM10.5 15C10.5 14.5858 10.1642 14.25 9.75 14.25C9.33579 14.25 9 14.5858 9 15V17C9 17.4142 9.33579 17.75 9.75 17.75C10.1642 17.75 10.5 17.4142 10.5 17V15ZM13.5 15C13.5 14.5858 13.1642 14.25 12.75 14.25C12.3358 14.25 12 14.5858 12 15V17C12 17.4142 12.3358 17.75 12.75 17.75C13.1642 17.75 13.5 17.4142 13.5 17V15Z" />
                <circle cx="19.25" cy="5.5" r="5.5" />
            </svg>
        `;
    cartData = getDataCart() || {};
    let cartButtons = document.getElementById("cart-buttons");
    cartButtons.innerHTML = '';
    cartButtons.insertAdjacentHTML("afterbegin", `
        <div class="dish-input-container">
            <input type="button" value="-" id="minus-dish-${dish}" data-id="${dish}" onclick="decrementValue('modal-dish-${dish}', '${dish}', this)"
                class="button-minus" data-field="${dish}">
            <input type="number" step="1" min="1" max="100" value="${cartData[dish]
            }" id="modal-dish-${dish}"
                class="numbers-field" onkeyup="checkNum('${dish}')">
            <input type="button" value="+" data-id="${dish}" onclick="incrementValue('modal-dish-${dish}', '${dish}', this)"
                class="button-plus" data-field="${dish}">
        </dev>
    `);

    let dishName = '';
    let dishPrice = 0;
    let dishCategory = '';
    for (let item of dishes) {
        if (item._id == dish) {
            dishName  = item.language.uk.name;
            dishPrice = item.price;

            for (let itemCateg of categories) {
                if (itemCateg._id == item.category) {
                    dishCategory = itemCateg.language.uk.name;
                }
            }
        }
    }

    dataLayer.push({ecommerce: null});
    dataLayer.push({
        event: "add_to_cart",
        ecommerce: {
            items: [{
                item_name: dishName,
                price:  dishPrice,
                item_category: dishCategory,
                quantity: 1
            }]
        }
    });

    button.disabled = false;
}

function checkCart() {
    let cartData = getDataCart();
    if (Object.keys(cartData).length == 0) {
        cart.classList.remove("modal-trigger");
        cart.removeAttribute("href");
        cartMob.removeAttribute("href");
        cartMob.classList.remove("modal-trigger");
        M.toast({
            html: `<b style="color:red;">{{ _('Ваш кошик порожній') }}!</b>`,
        });
    } else {
        cart.classList.add("modal-trigger");
        cart.href = cartMob.href = "#modal_cart";
        cartMob.classList.add("modal-trigger");
    }
}

function formDelivery() {
    let cartDelivery = document.getElementById('cartDelivery');
    let cartPickup = document.getElementById('cartPickup');
    cartDelivery.classList.add("active");
    cartPickup.classList.remove("active");
    let form = document.querySelector('.form-cart');
    let target = form.children[5];
    if (!document.getElementById('address')) {
        elemSuma.insertAdjacentHTML("afterend", deliveryMarkup);
        target.insertAdjacentHTML('afterend', `
            <div id="address">
                <div class="row input-field">
                    <input class="col s12 autocomplete" type="text" name="street" id="street"
                        placeholder="{{ _('Ваша вулиця') }}" required>
                    <label for="street" class="active">{{ _("Вулиця") }}</label>
                </div>
                <div class="col s12">
                    <input type="text" name="house" placeholder="{{ _('Будинок') }}">
                    <input type="text" name="flat" placeholder="{{ _('Квартира') }}">
                    <input type="text" name="porch" placeholder="{{ _('Під\'їзд') }}">
                </div>
            </div>
        `);
        let target2 = form.children[8];
        console.log(target2)
        target2.insertAdjacentHTML('afterend', `
            <div id="type_delivery" class="input-field detail-delivery">
                <select name="detail_delivery" required>
                    <option value="porch" selected>{{ _('До Під\'їзду') }} 50 {{ _('GBP') }}</option>
                    <option value="door">{{ _('До дверей') }} 55 {{ _('GBP') }}</option>
                </select>
                <label>{{ _('Тип доставки') }}</label>
            </div>
        `);
        $('select').formSelect();
    }
    $('input.autocomplete').autocomplete({
        data: streets,
        minLength: 3,
        limit: 5
    });
    document.getElementById('delivery').value = true
}

function formPickup() {
    let cartDelivery = document.getElementById('cartDelivery');
    let cartPickup = document.getElementById('cartPickup');
    cartDelivery.classList.remove("active");
    cartPickup.classList.add("active");
    document.getElementById('address').remove();
    document.getElementById('type_delivery').remove();
    document.getElementById('sum-delivery').remove();
    document.getElementById('delivery').value = false;

}

function book() {
    M.toast({
        html: `<b style='color:green;'>{{ _('Замовлення прийнято, чекайте дзвінка оператора') }}</b>`,
    });
}

function orderCart() {
    M.toast({
        html: `<b style='color:green;'>{{ _('Замовлення прийнято, чекайте дзвінка оператора') }}</b>`,
    });
    setDataCart({});
}

$(window).scroll(function () {
    scrollNavbar();
});

$(document).ready(function () {
    $(".sidenav").sidenav();
    $(".modal").modal();
    scrollNavbar();
    if (document.querySelectorAll(".flashes")[0]) {
        let msg = document
            .querySelectorAll(".flashes")[0]
            .getElementsByTagName("li");
        M.toast({
            html: `<b style="color:red;">${msg[0].innerText}</b>`,
        });
    }
    try {
        document.querySelectorAll('#main-slider').forEach((item, index) => {
            if (item.querySelectorAll('.slider__item').length > 1) {
                const id = 'slider-' + index;
                item.id = id;
                new SimpleAdaptiveSlider('#' + id, {
                    loop: true,
                    autoplay: true,
                    interval: 5000,
                    swipe: true,
                });
            }
        });
    } catch {}
    let cartData = getDataCart();
    if (Object.keys(cartData).length == 0) {
        cart.innerHTML = cartMob.innerHTML = `
            <svg class="empty-cart" width="24" height="22" viewBox="0 0 24 22" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M1 7H2M19 7H18M18 7L17 17H3L2 7M18 7H16H14M2 7H4H6M10 11V13M13 11V13M7 11V13M6 7H14M6 7V5C6 3.66667 6.8 1 10 1C13.2 1 14 3.66667 14 5V7"
                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        `;
    } else {
        cart.innerHTML = cartMob.innerHTML = `
            <svg class="active-cart" width="24" height="22" viewBox="0 0 25 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M11.7984 4.64321C11.2233 4.39554 10.544 4.25 9.75 4.25C7.90556 4.25 6.6804 5.03532 5.94135 6.06177C5.22984 7.04998 5 8.21332 5 9V10.25H3.75H1.75H0.75C0.335786 10.25 0 10.5858 0 11C0 11.4142 0.335786 11.75 0.75 11.75H1.07126L2.00372 21.0746C2.04206 21.458 2.36469 21.75 2.75 21.75H16.75C17.1353 21.75 17.4579 21.458 17.4963 21.0746L18.3096 12.9416C17.8008 12.878 17.3078 12.7633 16.836 12.603L16.0713 20.25H3.42874L2.57874 11.75H3.75H5.75H13.75H15.1028C14.2698 11.1962 13.5538 10.4802 13 9.64724V10.25H6.5V9C6.5 8.45335 6.67016 7.61668 7.15865 6.93823C7.6196 6.29802 8.39444 5.75 9.75 5.75C10.676 5.75 11.3311 6.00575 11.8001 6.37193C11.767 6.08588 11.75 5.79493 11.75 5.5C11.75 5.21027 11.7664 4.92438 11.7984 4.64321ZM7.5 15C7.5 14.5858 7.16421 14.25 6.75 14.25C6.33579 14.25 6 14.5858 6 15V17C6 17.4142 6.33579 17.75 6.75 17.75C7.16421 17.75 7.5 17.4142 7.5 17V15ZM10.5 15C10.5 14.5858 10.1642 14.25 9.75 14.25C9.33579 14.25 9 14.5858 9 15V17C9 17.4142 9.33579 17.75 9.75 17.75C10.1642 17.75 10.5 17.4142 10.5 17V15ZM13.5 15C13.5 14.5858 13.1642 14.25 12.75 14.25C12.3358 14.25 12 14.5858 12 15V17C12 17.4142 12.3358 17.75 12.75 17.75C13.1642 17.75 13.5 17.4142 13.5 17V15Z" />
                <circle cx="19.25" cy="5.5" r="5.5" />
            </svg>
        `;
        document.getElementById('delivery').value = true
        inputCart.value = JSON.stringify(cartData);
        let dishCartList = Object.keys(cartData);
        for (let item of dishes) {
            for (let itemArray of dishCartList) {
                if (item._id == itemArray) {
                    let markup = markupGenerator(item, cartData);
                    dishCart.insertAdjacentHTML("beforeend", markup);
                    suma += Number(cartData[itemArray]) * Number(item.price);
                    elemSuma.innerText = suma +' {{ _("GBP") }}';
                    inputSuma.value = suma
                }
            }
        }
    }
    elemSuma.insertAdjacentHTML("afterend", deliveryMarkup);
    $('select').formSelect();
    $('input.autocomplete').autocomplete({
        data: streets,
        minLength: 3,
        limit: 5
    });

    let timeOptions = {
        mask: "HH:MM",
        blocks: {
            HH: {
                mask: IMask.MaskedRange,
                from: 0,
                to: 23,
            },
            MM: {
                mask: IMask.MaskedRange,
                from: 0,
                to: 59,
            },
        },
    }

    let phoneOptions = {
        mask: '+{38}(000)000-00-00'
    }

    IMask(document.getElementById("time"), timeOptions);
    IMask(document.getElementById("time_cart"), timeOptions);
    IMask(document.getElementById("phone"), phoneOptions);
    IMask(document.getElementById("phone_cart"), phoneOptions);
});
